var currentlySearching=false;var searchAgain=false;function performSearch(){if(!currentlySearching){currentlySearching=true}else{searchAgain=true;return}var b="state="+$("status").value;b+="&race="+$("race").value;b+="&sex="+$("sex").value;b+="&online="+$("online").value;b+="&server="+$("server").value;b+="&search="+encodeURIComponent($("search").value);b+="&acc="+($("search_in_account").checked?"1":"0");b+="&email="+($("search_in_email").checked?"1":"0");b+="&char="+($("search_in_char").checked?"1":"0");$("search_title").setStyle({background:"#000 url("+url+"/shared/pics/ajax-loading-small.gif) no-repeat scroll 2px 2px"});var a=new Ajax.Request(url+"/illarion/gmtool/ajax_search_chars.php",{method:"post",parameters:b,evalJS:false,onComplete:function(c){var d=$("output_area");if(Object.isUndefined(c.responseXML)){addOrReplaceChild(d,document.createTextNode("Error - Invalid XML"))}else{addOrReplaceChild(d,parseResponse(c.responseXML))}currentlySearching=false;if(searchAgain){searchAgain=false;performSearch()}else{$("search_title").setStyle({background:""})}}})}function parseResponse(f){if(f.nodeType==9){if(f.childNodes.length>0){for(var g=0;g<f.childNodes.length;g++){if(f.childNodes[g].nodeType!=10&&f.childNodes[g].nodeType!=7){return parseResponse(f.childNodes[g])}}}}else{if(f.nodeType==1){if(f.nodeName=="manyHits"){var m=0;var j=0;for(var g=0;g<f.childNodes.length;g++){if(f.childNodes[g].nodeName=="found"){m=f.childNodes[g].firstChild.nodeValue}else{if(f.childNodes[g].nodeName=="max"){j=f.childNodes[g].firstChild.nodeValue}}}if(cur_lang=="de"){return document.createTextNode(m+" von "+j+" Charaktere entsprechen der Suche. Bitte gib genauere Suchparameter an.")}else{return document.createTextNode(m+" of "+j+" characters fit the search. Please specify your search parameters more exactly.")}}else{if(f.nodeName=="nothing"){if(cur_lang=="de"){return document.createTextNode("Keine Charaktere entsprechen den Suchparametern.")}else{return document.createTextNode("No characters fit the search parameters.")}}else{if(f.nodeName=="characters"){var d=document.createElement("div");var h=0;var n=null;for(var g=0;g<f.childNodes.length;g++){if(f.childNodes[g].nodeName!="char"){continue}if(h==0){n=document.createElement("ul");n.style.cssText="float:left;margin-right:10px;"}var a="";var c="";for(var e=0;e<f.childNodes[g].childNodes.length;e++){if(f.childNodes[g].childNodes[e].nodeName=="name"){a=f.childNodes[g].childNodes[e].firstChild.nodeValue}else{if(f.childNodes[g].childNodes[e].nodeName=="id"){c=f.childNodes[g].childNodes[e].firstChild.nodeValue}}}var l=document.createElement("li");l.appendChild(document.createTextNode(c));l.appendChild(document.createTextNode(" - "));var b=document.createElement("a");b.href=url+"/illarion/gmtool/"+cur_lang+"_character.php?id="+c;b.appendChild(document.createTextNode(a));l.appendChild(b);n.appendChild(l);h++;if(h==10){d.appendChild(n);h=0}}if(h>0){d.appendChild(n)}return d}}}}}}function clearChilds(a){if(a.hasChildNodes()){while(a.childNodes.length>=1){a.removeChild(a.firstChild)}}}function addOrReplaceChild(a,b){if(a.firstChild){a.replaceChild(b,a.firstChild)}else{a.appendChild(b)}};